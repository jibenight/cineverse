<% content_for(:title) { "Pr\u00e9f\u00e9rences newsletter" } %>
<div class="max-w-3xl mx-auto px-6 py-8">
  <section class="bg-white dark:bg-[#1A1A1A] rounded-lg p-6 shadow-sm">
    <h1 class="text-lg font-bold mb-2">Pr&eacute;f&eacute;rences newsletter</h1>
    <p class="text-sm text-neutral-400 mb-6">Choisissez les newsletters que vous souhaitez recevoir.</p>

    <%= form_with url: newsletter_preferences_path(@subscriber.confirmation_token), method: :patch, class: "space-y-4" do |f| %>
      <% NewsletterPreference.categories.each_key do |category| %>
        <% pref = @preferences.find { |p| p.category == category } %>
        <div class="flex items-center justify-between py-3 border-b border-neutral-100 dark:border-neutral-800 last:border-0">
          <div>
            <p class="text-sm font-medium"><%= category.titleize.gsub("_", " ") %></p>
            <p class="text-xs text-neutral-400">
              <% case category %>
              <% when "weekly_picks" %>
                Notre s&eacute;lection hebdomadaire de films &agrave; ne pas manquer
              <% when "new_releases" %>
                Les nouvelles sorties en salle chaque semaine
              <% when "community_highlights" %>
                Les meilleures critiques et activit&eacute;s de la communaut&eacute;
              <% when "deals" %>
                Bons plans et r&eacute;ductions cin&eacute;ma
              <% end %>
            </p>
          </div>
          <input type="hidden" name="preferences[<%= category %>]" value="0">
          <input type="checkbox" name="preferences[<%= category %>]" value="1" <%= "checked" if pref&.enabled? %> class="rounded border-neutral-300 dark:border-neutral-600 text-amber-500 focus:ring-amber-500">
        </div>
      <% end %>

      <div class="pt-2">
        <%= f.submit "Enregistrer", class: "px-4 py-2 rounded-lg bg-amber-500 hover:bg-amber-600 text-white text-sm font-medium transition cursor-pointer" %>
      </div>
    <% end %>

    <div class="mt-6 pt-4 border-t border-neutral-100 dark:border-neutral-800">
      <p class="text-xs text-neutral-400">
        Vous pouvez &eacute;galement
        <%= link_to "vous d&eacute;sinscrire compl&egrave;tement", newsletter_unsubscribe_path(@subscriber.confirmation_token), class: "text-amber-500 hover:underline" %>.
      </p>
    </div>
  </section>
</div>
